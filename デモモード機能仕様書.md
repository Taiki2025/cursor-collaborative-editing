# デモモード機能仕様書

## 概要
九州電力AIエージェントUIのデモモード機能について、シナリオ選択、AIチャットボット対応、アラート検出機能の詳細を説明します。

## 1. デモモード基本機能

### 1.1 デモモード切り替え
- **機能**: デモモードのON/OFF切り替え
- **UI要素**: 
  - ヘッダーの「デモモード」ボタン
  - 左カラムのデモスイッチ
- **動作**: 
  - デモモードON時: シナリオ選択パネルが表示される
  - デモモードOFF時: シナリオ選択パネルが非表示になる

### 1.2 シナリオ選択機能
- **機能**: 5つの基本シナリオと3つのイレギュラーシナリオから選択
- **基本シナリオ**:
  1. **停電対応** (OUTAGE) - 再点申込フロー
  2. **請求確認** (BILLING) - 請求額・支払期限確認
  3. **プラン変更** (CHANGE_PLAN) - プラン変更手続き
  4. **契約廃止** (TERMINATION) - 解約手続き
  5. **使用量計算～料金計算** - 料金シミュレーション

- **イレギュラーシナリオ**:
  1. **ハラスメント対応** (HARASSMENT) - パワハラ検知
  2. **セクハラ対応** (SEXUAL_HARASSMENT) - セクハラ検知
  3. **伝達漏れ対応** (MISSING_INFO) - 伝達漏れ検知

## 2. シナリオ詳細仕様

### 2.1 停電対応シナリオ
```json
{
  "code": "OUTAGE",
  "name": "停電対応",
  "icon": "⚡",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "もしもし、電気が止まってしまったんですが…"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "申し訳ありません。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678です。"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "未収¥15,430、最終入金2025/05/20です。"},
    {"timestamp": "14:00:30", "speaker": "オペレーター", "text": "再点候補は08/12 09:00,13:00,15:30です。いかがですか？"},
    {"timestamp": "14:00:45", "speaker": "顧客", "text": "13:00でお願いします。"},
    {"timestamp": "14:01:00", "speaker": "オペレーター", "text": "予約完了しました。予約ID: RES-20250812-0001"}
  ],
  "summaryUpdates": [
    {"time": "14:00:15", "summary": "未収¥15,430／最終入金2025/05/20を確認"},
    {"time": "14:00:25", "summary": "再点希望13:00で予約指示"},
    {"time": "14:01:00", "summary": "予約完了：RES-20250812-0001"}
  ]
}
```

### 2.2 請求確認シナリオ
```json
{
  "code": "BILLING",
  "name": "請求確認",
  "icon": "💰",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "今月の請求額を確認したいのですが"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "承知いたしました。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678です。"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "2025年7月分の請求額は¥7,980です。"},
    {"timestamp": "14:00:20", "speaker": "顧客", "text": "支払期限はいつですか？"},
    {"timestamp": "14:00:25", "speaker": "オペレーター", "text": "支払期限は2025年8月20日です。"},
    {"timestamp": "14:00:30", "speaker": "顧客", "text": "ありがとうございます。"}
  ]
}
```

### 2.3 プラン変更シナリオ
```json
{
  "code": "CHANGE_PLAN",
  "name": "プラン変更",
  "icon": "🔄",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "プランを変更したいのですが"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "承知いたしました。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678です。"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "現在はナイト・セレクトプランですね。"},
    {"timestamp": "14:00:20", "speaker": "顧客", "text": "レギュラープランに変更したいです。"},
    {"timestamp": "14:00:25", "speaker": "オペレーター", "text": "月額¥1,220の増額になりますが、よろしいですか？"},
    {"timestamp": "14:00:30", "speaker": "顧客", "text": "はい、お願いします。"},
    {"timestamp": "14:00:35", "speaker": "オペレーター", "text": "変更完了しました。適用開始は9月1日です。"}
  ]
}
```

### 2.4 契約廃止シナリオ
```json
{
  "code": "TERMINATION",
  "name": "契約廃止",
  "icon": "🚪",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "契約を廃止したいのですが"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "承知いたしました。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678です。"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "廃止理由をお聞かせください。"},
    {"timestamp": "14:00:20", "speaker": "顧客", "text": "引越しのためです。"},
    {"timestamp": "14:00:25", "speaker": "オペレーター", "text": "希望廃止日はいつでしょうか？"},
    {"timestamp": "14:00:30", "speaker": "顧客", "text": "7月31日でお願いします。"},
    {"timestamp": "14:00:35", "speaker": "オペレーター", "text": "廃止手続き完了しました。最終請求書を送付いたします。"}
  ]
}
```

## 3. イレギュラー対応シナリオ

### 3.1 ハラスメント対応シナリオ
```json
{
  "code": "HARASSMENT",
  "name": "ハラスメント対応",
  "icon": "⚠️",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "お前ら電力会社はどうしてこんなに高いんだ！"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "申し訳ございません。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678だ！"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "料金についてご相談ですね。詳しくお聞かせください。"},
    {"timestamp": "14:00:20", "speaker": "顧客", "text": "バカヤロー！こんなに高いのはおかしいだろ！"},
    {"timestamp": "14:00:25", "speaker": "オペレーター", "text": "お客様のご不満をお聞かせください。冷静にお話ししましょう。"},
    {"timestamp": "14:00:30", "speaker": "顧客", "text": "もういい！切るぞ！"}
  ],
  "alerts": [
    {
      "type": "HARASSMENT",
      "message": "パワハラワード検出：「バカヤロー」「お前ら」",
      "severity": "HIGH",
      "timestamp": "14:00:20"
    }
  ],
  "sharedInfo": [
    {
      "type": "MISSING_INFO",
      "message": "料金の詳細説明が未実施",
      "priority": "MEDIUM",
      "timestamp": "14:00:25"
    }
  ]
}
```

### 3.2 セクハラ対応シナリオ
```json
{
  "code": "SEXUAL_HARASSMENT",
  "name": "セクハラ対応",
  "icon": "🚨",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "もしもし、美人のオペレーターさんかな？"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "申し訳ございません。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678です。声が可愛いね。"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "ご用件をお聞かせください。"},
    {"timestamp": "14:00:20", "speaker": "顧客", "text": "デートしない？"},
    {"timestamp": "14:00:25", "speaker": "オペレーター", "text": "業務以外の話はお受けできません。ご用件をお聞かせください。"},
    {"timestamp": "14:00:30", "speaker": "顧客", "text": "切るよ。"}
  ],
  "alerts": [
    {
      "type": "SEXUAL_HARASSMENT",
      "message": "セクハラ検知：「美人」「可愛い」「デート」",
      "severity": "HIGH",
      "timestamp": "14:00:20"
    }
  ],
  "sharedInfo": [
    {
      "type": "MISSING_INFO",
      "message": "業務用件の確認が未完了",
      "priority": "HIGH",
      "timestamp": "14:00:25"
    }
  ]
}
```

### 3.3 伝達漏れ対応シナリオ
```json
{
  "code": "MISSING_INFO",
  "name": "伝達漏れ対応",
  "icon": "📝",
  "transcript": [
    {"timestamp": "14:00:01", "speaker": "顧客", "text": "料金の支払い方法を教えてください"},
    {"timestamp": "14:00:05", "speaker": "オペレーター", "text": "承知いたしました。契約番号をお願いします。"},
    {"timestamp": "14:00:12", "speaker": "顧客", "text": "CTR-09-1234-5678です。"},
    {"timestamp": "14:00:15", "speaker": "オペレーター", "text": "口座振替、クレジットカード、コンビニ支払いがございます。"},
    {"timestamp": "14:00:20", "speaker": "顧客", "text": "口座振替の手続きをしたいです。"},
    {"timestamp": "14:00:25", "speaker": "オペレーター", "text": "承知いたしました。手続き完了いたします。"},
    {"timestamp": "14:00:30", "speaker": "顧客", "text": "ありがとうございます。"}
  ],
  "sharedInfo": [
    {
      "type": "MISSING_INFO",
      "message": "口座振替の手続き方法詳細説明が未実施",
      "priority": "MEDIUM",
      "timestamp": "14:00:25"
    },
    {
      "type": "MISSING_INFO",
      "message": "手続き完了後の確認方法説明が未実施",
      "priority": "LOW",
      "timestamp": "14:00:30"
    }
  ]
}
```

## 4. AIチャットボット対応

### 4.1 キーワードトリガー機能
```json
{
  "keywords": [
    {
      "scenario": "OUTAGE",
      "trigger": "電気が止まった",
      "bot_prompt": "停電とのことですので、再点申込の手順をご案内します。契約番号をお願いします。"
    },
    {
      "scenario": "BILLING",
      "trigger": "請求額",
      "bot_prompt": "最新の請求額は¥7,980です。支払期限は2025/08/20になります。"
    },
    {
      "scenario": "CHANGE_PLAN",
      "trigger": "プラン変更",
      "bot_prompt": "プラン変更の手続きをご案内します。現在のプランと希望プランをお聞かせください。"
    },
    {
      "scenario": "TERMINATION",
      "trigger": "契約廃止",
      "bot_prompt": "契約廃止の手続きをご案内します。廃止理由と希望日をお聞かせください。"
    },
    {
      "scenario": "HARASSMENT",
      "trigger": "バカヤロー",
      "bot_prompt": "お客様のご不満をお聞かせください。冷静にお話ししましょう。"
    },
    {
      "scenario": "SEXUAL_HARASSMENT",
      "trigger": "美人",
      "bot_prompt": "業務以外の話はお受けできません。ご用件をお聞かせください。"
    }
  ]
}
```

### 4.2 チャットボット応答機能
- **機能**: 通話ログの顧客発言からキーワードを検出し、自動応答
- **応答タイミング**: 顧客発言から1秒後に自動応答
- **応答内容**: シナリオに応じた適切な案内・説明

## 5. アラート検出機能

### 5.1 アラートタイプ
1. **パワハラ検知** (HARASSMENT)
   - 検出ワード: 「バカヤロー」「お前ら」「クソ」など
   - 重要度: HIGH
   - 対応: 即座にアラート表示、上長通知

2. **セクハラ検知** (SEXUAL_HARASSMENT)
   - 検出ワード: 「美人」「可愛い」「デート」など
   - 重要度: HIGH
   - 対応: 即座にアラート表示、管理者通知

3. **伝達漏れ検知** (MISSING_INFO)
   - 検出項目: 重要な説明漏れ、手続き方法の説明不足
   - 重要度: MEDIUM/LOW
   - 対応: 共有事項として表示

### 5.2 アラート表示仕様
```css
.alert-panel {
    background: #fff5f5;
    border: 1px solid #fed7d7;
    border-radius: 8px;
    animation: slideInDown 0.5s ease-out;
}

.alert-item {
    background: #fff;
    border-left: 4px solid #e53e3e;
    padding: 8px 12px;
    margin-bottom: 10px;
}
```

## 6. 共有事項表示機能

### 6.1 共有事項タイプ
1. **伝達漏れ** (MISSING_INFO)
   - 説明不足の項目を検出
   - 優先度: MEDIUM/LOW

2. **重要情報** (IMPORTANT_INFO)
   - 顧客から重要な情報が提供された場合
   - 優先度: HIGH

3. **フォローアップ** (FOLLOW_UP)
   - 後続対応が必要な項目
   - 優先度: MEDIUM

### 6.2 共有事項表示仕様
```css
.shared-info-panel {
    background: #f0fff4;
    border: 1px solid #c6f6d5;
    border-radius: 8px;
    animation: slideInDown 0.5s ease-out;
}

.shared-item {
    background: #fff;
    border-left: 4px solid #38a169;
    padding: 8px 12px;
    margin-bottom: 10px;
}
```

## 7. シナリオ再生機能

### 7.1 再生タイミング
- **メッセージ表示**: 2秒間隔
- **要約更新**: 8秒間隔
- **アラート表示**: 10秒間隔
- **共有事項表示**: 12秒間隔

### 7.2 再生制御
- **開始**: シナリオ選択時に自動開始
- **停止**: デモモードOFF時、または新しいシナリオ選択時
- **リセット**: 通話ログ、要約、アラート、共有事項をクリア

## 8. データ構造

### 8.1 シナリオデータ構造
```json
{
  "scenarios": [
    {
      "code": "シナリオコード",
      "name": "シナリオ名",
      "icon": "アイコン",
      "transcript": [
        {
          "timestamp": "時刻",
          "speaker": "話者",
          "text": "発言内容"
        }
      ],
      "summaryUpdates": [
        {
          "time": "時刻",
          "summary": "要約内容"
        }
      ],
      "alerts": [
        {
          "type": "アラートタイプ",
          "message": "アラートメッセージ",
          "severity": "重要度",
          "timestamp": "時刻"
        }
      ],
      "sharedInfo": [
        {
          "type": "共有事項タイプ",
          "message": "共有事項メッセージ",
          "priority": "優先度",
          "timestamp": "時刻"
        }
      ]
    }
  ]
}
```

## 9. 実装ファイル構成

### 9.1 主要ファイル
- `index.html` - メインHTMLファイル
- `style.css` - スタイルシート
- `script.js` - JavaScript機能実装
- `dummy_data_v2.json` - シナリオデータ

### 9.2 データファイル
- `dummy_data_v2.json` - シナリオとキーワードデータ
- `keywords.json` - キーワードデータ（フォールバック）

## 10. 使用方法

### 10.1 デモモード開始
1. ヘッダーの「デモモード」ボタンをクリック
2. 左カラムのシナリオ選択パネルが表示される
3. 実行したいシナリオを選択
4. シナリオが自動再生開始

### 10.2 シナリオ切り替え
1. デモモード中に別のシナリオボタンをクリック
2. 現在のシナリオが停止し、新しいシナリオが開始
3. 通話ログ、要約、アラート、共有事項がリセット

### 10.3 チャットボット利用
1. 右カラムのチャット入力欄に質問を入力
2. キーワードに応じた自動応答が表示
3. FAQボタンでよくある質問を選択可能

## 11. 今後の拡張予定

### 11.1 機能拡張
- 音声認識によるリアルタイム文字起こし
- 感情分析による顧客満足度測定
- 機械学習による応答精度向上

### 11.2 シナリオ拡張
- より多くの業務シナリオ追加
- カスタムシナリオ作成機能
- シナリオ編集機能

### 11.3 アラート機能拡張
- より詳細なハラスメント検知
- 音声トーン分析
- 自動エスカレーション機能
